---
import type { IconifyJSON } from "@iconify/types";

interface Props extends astroHTML.JSX.SVGAttributes {
  prefix: string;
  icon: string;
}

const { prefix, icon, ...rest } = Astro.props;
const iconify = `https://api.iconify.design/${prefix}.json?icons=${icon}`;

const iconJson = await fetch(iconify).then<IconifyJSON>((r) => r.json());

const iconData = iconJson.icons[icon];

const viewBox = [
  iconData.left ?? iconJson.left ?? 0,
  iconData.top ?? iconJson.top ?? 0,
  iconData.width ?? iconJson.width ?? 16,
  iconData.height ?? iconJson.height ?? 16,
].join(" ");
---

<svg viewBox={viewBox} {...rest} set:html={iconData.body} />
